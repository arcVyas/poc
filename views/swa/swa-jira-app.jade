doctype html
html
  - var cnt =1
  head
    title Jira App
    link(rel="stylesheet" type="text/css" href="https://bootswatch.com/flatly/bootstrap.css")
    link(rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs/jqc-1.12.3/dt-1.10.12/af-2.1.2/b-1.2.1/cr-1.3.2/fc-3.2.2/fh-3.1.2/r-2.1.0/se-1.2.0/datatables.min.css")
  body
    #wrapper
      .row
        .col-lg-12
          div(class="panel panel-info")
            .panel-heading
              h4.panel-title
                  span Jira App
                  //span(style="float:right") Total Story points : #{data.totalPoints}
                  span(style="float:right") a GetMeCoffeee app
            .panel-body
              .row.col-lg-12
                  .span
                    .h4 Features and Stories
              .row.col-lg-12
                .table-responsive
                  table.table.table-bordered.table-hover.table-striped(id="story-table")
                    thead
                      tr
                        th Sprint
                        th Feature
                        th Story
                        th Summary
                        //th Points
                        th Status
                        th Assignee
                        //th comments
                    tbody
                      each ticket in data.stories
                        -var tdColor="transparent"
                        -var tdStyle=""
                        if(ticket.status == "Resolved" || ticket.status == "Closed")
                          - tdColor = "lightgreen"
                        if(ticket.status == "Ready for Sign Off")
                          - tdColor = "yellow"
                        if(ticket.sprint == "Total points")
                          - tdStyle = "font-weight:bold;"
                        tr
                          td(style='#{tdStyle}') #{ticket.sprint}
                          td
                            a(href='https://#{jiraHost}/browse/#{ticket.key}/overview', target='_blank') #{ticket.key}
                          td
                            a(href='https://#{jiraHost}/browse/#{ticket.subTaskKey}/overview', target='_blank') #{ticket.subTaskKey}
                          - if(ticket.subTaskKey=="")
                            td
                              span(style='font-weight:bold;text-transform:camelcase;') #{ticket.summary}
                          - else
                            td
                              span(style='font-style: italic') #{ticket.summary}
                          //td(style='#{tdStyle}') #{ticket.points}
                          td(bgcolor='#{tdColor}') #{ticket.status}
                          td #{ticket.assignee}
                          //td
                            //textarea(rows="1")
                .row.col-lg-12
                hr
                .row.col-lg-12
                  .span
                    .h4 Status Split
                .row
                  .col-lg-4
                    .table-responsive
                      table.table.table-bordered.table-hover.table-striped(id="story-table-statusGrp")
                        thead
                          tr
                            th Status-Grouped
                            th Count
                        tbody
                          each count, status in data.statusGrpPivot
                            tr
                              td #{status}
                              td #{count}
                  .col-lg-4
                    .table-responsive
                      table.table.table-bordered.table-hover.table-striped(id="story-table-rw")
                        thead
                          tr
                            th Status
                            th Count
                        tbody
                          each count, status in data.statusPivot
                            tr
                              td #{status}
                              td #{count}
                  .col-lg-4
                    .table-responsive
                      table.table.table-bordered.table-hover.table-striped(id="story-table-resource")
                        thead
                          tr
                            th Resource
                            th Count
                        tbody
                          each count, resource in data.resourcePivot
                            tr
                              td #{resource}
                              td #{count}

    script(src='//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js')
    script(src='/bootstrap/js/bs-min.js')
    script(type="text/javascript" src="https://cdn.datatables.net/v/bs-3.3.6/jq-2.2.3/jszip-2.5.0/pdfmake-0.1.18/dt-1.10.12/af-2.1.2/b-1.2.2/b-colvis-1.2.2/b-flash-1.2.2/b-html5-1.2.2/b-print-1.2.2/cr-1.3.2/fh-3.1.2/kt-2.1.3/r-2.1.0/rr-1.1.2/se-1.2.0/datatables.min.js")
    script.
      $(document).ready( function () {
        $('#story-table').dataTable({
          "buttons": ['copy','excel', 'pdf'],
          "iDisplayLength": 100,
          "order": [[ 1, "asc" ],[2, "asc"]],
          dom: 'Bfrtlip'
        });
        $('#story-table-rw').dataTable({
          "buttons": ['copy','excel', 'pdf'],
          "iDisplayLength": 10,
          "bPaginate": false,
          "sDom": 'Blrtp',
          "order": [[ 1, "desc" ]]
        });
        $('#story-table-statusGrp').dataTable({
          "buttons": ['copy','excel', 'pdf'],
          "iDisplayLength": 10,
          "bPaginate": false,
          "sDom": 'Blrtp',
          "order": [[ 1, "desc" ]]
        });
        $('#story-table-resource').dataTable({
          "buttons": ['copy','excel', 'pdf'],
          "iDisplayLength": 10,
          "bPaginate": false,
          "sDom": 'Blrtp',
          "order": [[ 1, "desc" ]]
        });
      });
